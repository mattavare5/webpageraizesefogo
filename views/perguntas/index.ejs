<%- include("../partials/header", { page, titulo }) %>
<%- include("../partials/navbar") %>

<div class="pergunta-container">
  <h1 class="titulo-form">Perguntas</h1>

  <section class="perguntas-list">
    <div class="page-actions">
      <a href="/perguntas/nova" class="btn-enviar" style="display: inline-block; padding: 10px 20px; text-decoration: none; border-radius: 8px;">Nova Pergunta</a>
    </div>

    <% if (perguntas && perguntas.length) { %>
      <ul class="lista-perguntas">
        <% perguntas.forEach(p => { %>
          <li class="pergunta-item">
            <h3><a href="/perguntas/ver/<%= p.id %>"><%= p.titulo %></a></h3>
            <p><%= p.descricao.length > 200 ? p.descricao.substring(0,200) + "..." : p.descricao %></p>

            <div class="pergunta-actions">
              <a href="/perguntas/editar/<%= p.id %>">Editar</a>
              <form action="/perguntas/deletar/<%= p.id %>" method="POST" style="display:inline" onsubmit="return confirm('Deletar essa pergunta?');">
                <button type="submit" class="link-like">Deletar</button>
              </form>
            </div>
          </li>
        <% }); %>
      </ul>

      <nav class="pagination">
        <% if (currentPage > 1) { %>
          <a href="?page=<%= currentPage - 1 %>">Anterior</a>
        <% } %>
        <span>Página <%= currentPage %> de <%= totalPages %></span>
        <% if (currentPage < totalPages) { %>
          <a href="?page=<%= currentPage + 1 %>">Próxima</a>
        <% } %>
      </nav>

    <% } else { %>
      <p>Nenhuma pergunta encontrada. Seja o primeiro a criar!</p>
    <% } %>
  </section>
</div>

<%- include("../partials/footer") %>
